# Palo Alto Networks VWan Module for Azure

A Terraform module for deploying a Virtual Wan (VWan) and its components required for the firewalls in Azure.

## Usage

This module is designed to work in several *modes* depending on which variables or flags are set. Most common usage scenarios are:

- create all -  creates a VWan, Hub, Connections and Route Tables. In this mode, a VWAN and Hub are created. The connections and route tables are assigned to the Hub:

  ```hcl
virtual_wans = {
  "virtual_wan" = {
    name = "virtual_wan"
    virtual_hubs = {
      "virtual_hub" = {
        name           = "virtual_hub"
        address_prefix = "11.0.0.0/24"
      }
    }
    connections = {
      "app1-to-hub" = {
        name                       = "app1-to-hub"
        connection_type            = "Vnet"
        virtual_hub_key            = "virtual_hub"
        remote_virtual_network_key = "app1"
      }
   route_tables = {
      "route_table01" = {
        name            = "route_table01"
        virtual_hub_key = "virtual_hub"
        labels          = ["route_table01"]
      }
     }
    }
  }
}
  ```

- source a VWan and HUB but create Connections and Route Tables:

  ```hcl
virtual_wans = {
  "virtual_wan" = {
    create_virtual_wan = false
    name = "virtual_wan"
    resource_group_name = "virtual_wan_rg"
    
    virtual_hubs = {
      "virtual_hub" = {
        name           = "virtual_hub"
        resource_group_name = "virtual_hub_rg"
        create_virtual_hub = false
      }
    }
    connections = {
      "app1-to-hub" = {
        name                       = "app1-to-hub"
        connection_type            = "Vnet"
        virtual_hub_key            = "virtual_hub"
        remote_virtual_network_key = "app1"
      }
   route_tables = {
      "route_table01" = {
        name            = "route_table01"
        virtual_hub_key = "virtual_hub"
        labels          = ["route_table01"]
      }
     }
    }
  }
}
  ```